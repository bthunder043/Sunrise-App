<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sunrise Alarm</title>
<style>
  html,body {margin:0; height:100%; font-family:system-ui;}
  .screen {position:fixed; inset:0; background:#111; display:flex; align-items:center; justify-content:center;}
  #overlay {position:fixed; inset:0; background:rgba(255,147,41,0); pointer-events:none;}

  .panel {
    z-index:2; width:90%; max-width:360px;
    background:rgba(0,0,0,0.35); padding:20px;
    border-radius:16px; backdrop-filter:blur(6px);
    text-align:center; color:#fff;
  }

  h2{margin:0 0 14px; font-size:20px;}
  label{font-size:14px; display:block; margin-top:12px;}
  input[type="range"]{width:100%; margin-top:6px;}
  input[type="time"]{width:100%; padding:8px; border-radius:8px; border:none; margin-top:6px;}

  button{
    width:100%; padding:12px; margin-top:12px;
    border:none; border-radius:10px;
    background:#ffd27a; color:#111; font-weight:600; font-size:15px;
  }
</style>
</head>
<body>
<div class="screen">
  <div class="panel">
    <h2>Sunrise Alarm</h2>

    <label>Wake-up time (optional)</label>
    <input id="time" type="time">

    <label>Duration: <span id="dLbl">20</span> min</label>
    <input id="dur" type="range" min="1" max="60" value="20">

    <label>Warmth: <span id="wLbl">70</span>%</label>
    <input id="warm" type="range" min="20" max="100" value="70">

    <button id="start">Start Now</button>
    <button id="set">Start at Set Time</button>
    <button id="stop">Stop</button>
  </div>

  <div id="overlay"></div>
</div>

<script>
const overlay = document.getElementById("overlay");
const dur = document.getElementById("dur");
const warm = document.getElementById("warm");
const time = document.getElementById("time");
const dLbl = document.getElementById("dLbl");
const wLbl = document.getElementById("wLbl");

let startTime = null, duration = dur.value * 60 * 1000, running = false, raf;

dLbl.textContent = dur.value;
wLbl.textContent = warm.value;

dur.oninput = () => { dLbl.textContent = dur.value; duration = dur.value * 60000; };
warm.oninput = () => { wLbl.textContent = warm.value; };

function smooth(t){ return t*t*(3-2*t); }
function clamp(v){ return Math.max(0,Math.min(1,v)); }

function update(p){
  const s = smooth(p);
  const warmth = warm.value / 100;
  const r = Math.round(255 * warmth + 255 * (1-warmth));
  const g = Math.round(147 * warmth + 255 * (1-warmth));
  const b = Math.round(41  * warmth + 245 * (1-warmth));
  overlay.style.background = `rgba(${r},${g},${b},${0.95*s})`;
}

function step(){
  if(!running) return;
  const t = clamp((performance.now() - startTime) / duration);
  update(t);
  if(t >= 1){ running=false; cancelAnimationFrame(raf); return; }
  raf = requestAnimationFrame(step);
}

document.getElementById("start").onclick = () => {
  running = true;
  startTime = performance.now();
  step();
};

document.getElementById("stop").onclick = () => {
  running = false;
  cancelAnimationFrame(raf);
  overlay.style.background = "rgba(255,147,41,0)";
};

document.getElementById("set").onclick = () => {
  if(!time.value) return alert("Pick a time first");
  const now = new Date();
  const [h,m] = time.value.split(":").map(Number);

  let target = new Date();
  target.setHours(h,m,0,0);
  if(target < now) target.setDate(target.getDate()+1);

  const wait = target - now;
  alert("Alarm set");

  setTimeout(()=>{
    running = true;
    startTime = performance.now();
    step();
  }, wait);
};
</script>
</body>
</html>

